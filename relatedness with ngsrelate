#ngsRelate website: https://github.com/ANGSD/NgsRelate
#installing ngsRelate
git clone --recursive https://github.com/SAMtools/htslib
git clone https://github.com/ANGSD/ngsRelate
cd htslib/;make -j2;cd ../ngsRelate;make HTSSRC=../htslib/;

#First, we need to generate a file with allele frequencies (geno.file.mafs.gz) and a file with genotype likelihoods (geno.file.beagle.gz)

angsd -b bam.list -gl 2 -domajorminor 1 -snp_pval 1e-6 -domaf 1 -minmaf 0.05 -doGlf 3

### Then we extract the frequency column from the allele frequency file and remove the header (to make it in the format NgsRelate needs)

zcat geno.file.mafs.gz | cut -f5 |sed 1d > allele.freq

### run NgsRelate
#adjust -n (number of individuals)

ngsrelate  -G geno.file.beagle.gz -n 20 -f allele.freq  -O out.relatedness
